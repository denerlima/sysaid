<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<f:view xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">
	
	<p:dialog header="Cadastro Material" id="materialDialogId" 
		widgetVar="materialDialog" modal="true" closable="true" width="600" height="auto">
		
		<h:form id="materialDialogForm">
		    
			<div class="row">
				<div class="col-md-4">
					Material:		
				</div>
				<div class="col-md-8">
					<h:inputText id="material" value="#{materialBean.material.material}" required="true" label="Material" />
					<h:message for="material" styleClass="msg-error" />	
				</div>
			</div>
			
			
			<div class="row">
				<div class="col-md-4">
					Descrição:		
				</div>
				<div class="col-md-8">
					<p:inputTextarea id="descricao" rows="5" cols="40" value="#{materialBean.material.descricao}" required="true" label="Descrição"> 
						<f:validateLength minimum="4" />
					</p:inputTextarea>
					<h:message for="descricao" styleClass="msg-error" />
				</div>
			</div>
			
			
			<div class="row">
				<div class="col-md-4">
					Tipo Material:
				</div>
				<div class="col-md-8">
					<h:selectOneMenu id="tipoMaterial" value="#{materialBean.material.tipoMaterial}" required="true" label="Tipo Material">
						<f:selectItem itemValue="" itemLabel="Selecione" />
						<f:selectItems value="#{materialBean.allTiposMateriais}" var="tipo" itemLabel="#{tipo.descricao}" itemValue="#{tipo}" />				
					</h:selectOneMenu>
					<h:message for="tipoMaterial" styleClass="msg-error" />
				</div>
			</div>
			
			
			<div class="row">
				<div class="col-md-4">
					Aplicação:
				</div>
				<div class="col-md-8">
					<h:selectOneMenu id="aplicacao" value="#{materialBean.material.aplicacao}" required="true" label="Aplicação">
						<f:selectItem itemValue="" itemLabel="Selecione" />
						<f:selectItems value="#{materialBean.allAplicacoes}" var="app" itemLabel="#{app.descricao}" itemValue="#{app}" />					
					</h:selectOneMenu>
					<h:message for="aplicacao" styleClass="msg-error" />
				</div>
			</div>
			

			<div class="row">
				<div class="col-md-4">
					Marca:
				</div>
				<div class="col-md-8">
					<h:selectOneMenu id="marca" value="#{materialBean.material.marca}" required="true" label="Marca">
						<f:selectItem itemValue="" itemLabel="Selecione" />
						<f:selectItems value="#{materialBean.allMarcas}" var="marca" itemLabel="#{marca.descricao}" itemValue="#{marca}" />			
					</h:selectOneMenu>
					<h:message for="marca" styleClass="msg-error" />
				</div>
			</div>
			

			<div class="row">
				<div class="col-md-4">
					Grupo:		
				</div>
				<div class="col-md-8">
					<h:selectOneMenu id="grupo" value="#{materialBean.material.grupo}" required="true" label="Grupo">
						<f:selectItem itemValue="" itemLabel="Selecione" />
						<f:selectItems value="#{materialBean.allGrupos}" var="grupo" itemLabel="#{grupo.descricao} - #{grupo.grupopai}" itemValue="#{grupo}" />		
					</h:selectOneMenu>
					<h:message for="grupo" styleClass="msg-error" />
				</div>
			</div>
			
			
			<div class="row">
				<div class="col-md-4">
					Unidade de Medida de Entrada:		
				</div>
				<div class="col-md-8">
					<h:selectOneMenu id="entrada" value="#{materialBean.material.unidadeMedida}" required="true" label="Unidade Medida de Entrada">
						<f:selectItem itemValue="" itemLabel="Selecione" />
						<f:selectItems value="#{materialBean.allUnidadesMedidas}" var="um" itemLabel="#{um.unidadeEntrada}" itemValue="#{um}" />				
					</h:selectOneMenu>
					<h:message for="entrada" styleClass="msg-error" />
				</div>
			</div>
			
			
			<div class="row">
				<div class="col-md-4">
					Estoque Informado
				</div>
				<div class="col-md-8">
					<pe:inputNumber id="estoqueInformado" decimalPlaces="2" value="#{materialBean.material.estoqueInformado}" required="true" label="Estoque Informado" />
					<h:message for="estoqueInformado" styleClass="msg-error" />	
				</div>
			</div>
			
			
			<div class="row">
				<div class="col-md-4">
					Estoque Calculado
				</div>
				<div class="col-md-8">
					<h:outputText value="#{materialBean.material.estoqueCalculado}" />
				</div>
			</div>
			
			
			<div class="buttons">
								
				<p:commandButton action="#{materialBean.createMaterial}" value="Salvar"
					update=":materialDialogForm :materialForm"
					oncomplete="oncompleteMaterial(xhr, status, args)"
					rendered="#{not materialBean.managed}" />
					
				<p:commandButton action="#{materialBean.updateMaterial}" value="Alterar"
					update=":materialDialogForm :materialForm"
					oncomplete="oncompleteMaterial(xhr, status, args)"
					rendered="#{materialBean.managed}" />		
				
				<p:commandButton value="Cancelar" type="button" onclick="PF('materialDialog').hide();" />
			
			</div>
			
		</h:form>
			
	</p:dialog>
	
	<script type="text/javascript">
	   function oncompleteMaterial(xhr, status, args) {
	      if (args.success) {
	    	  PF('materialDialog').hide();
	      }
	   }
	</script>
	
</f:view>