<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:cp="http://java.sun.com/jsf/composite/components/property">
	
	<h:head>
		<title>SysAid</title>
		<ui:include src="/resources/css/stylePDF.xhtml" />		
	</h:head>
	<body>
	
		<center>
			<h2>Relatório de Custo por Unidade</h2>
		</center>
			
		<table>
			<tr>
				<td>
					<h:outputText value="Data Emissão:" />
				</td>
				<td colspan="3">
					<h:outputText value="#{relatorioExtraBean.custoPorUnidadeFilter.emissaoInicio}">
						<f:convertDateTime pattern="dd/MM/yyyy" type="both" />
					</h:outputText>
					à
					<h:outputText value="#{relatorioExtraBean.custoPorUnidadeFilter.emissaoFim}">
						<f:convertDateTime pattern="dd/MM/yyyy" type="both" />
					</h:outputText>
				</td>
			</tr>
			<tr>
				<td colspan="4">
					<h:outputText value="Imprimir os dados das Ordens de Serviços: " />
					<h:outputText value="#{relatorioExtraBean.custoPorUnidadeFilter.imprimirOrdemServico ? 'Sim' : 'Não'}" />
				</td>
			</tr>
			<tr>
				<td>
					<h:outputText value="Demandante:" />
				</td>
				<td colspan="3">
					<h:outputText value="#{relatorioExtraBean.custoPorUnidadeFilter.demandante.label}" />
				</td>
			</tr>
			<ui:fragment rendered="#{relatorioExtraBean.custoPorUnidadeFilter.nivel1 != null}">
				<tr>
					<td>
						<h:outputText value="Nível 1" />
					</td>
					<td colspan="3">
						<h:outputText id="nivel1" value="#{relatorioExtraBean.custoPorUnidadeFilter.nivel1.label}" />
					</td>
				</tr>
			</ui:fragment>
			<ui:fragment rendered="#{relatorioExtraBean.custoPorUnidadeFilter.nivel2 != null}">
				<tr>
					<td>
						<h:outputText value="Nível 2" />
					</td>
					<td colspan="3">
						<h:outputText id="nivel2" value="#{relatorioExtraBean.custoPorUnidadeFilter.nivel2.label}" />
					</td>
				</tr>
			</ui:fragment>
			<ui:fragment rendered="#{relatorioExtraBean.custoPorUnidadeFilter.nivel3 != null}">
				<tr>
					<td>
						<h:outputText value="Nível 3" />
					</td>
					<td colspan="3">
						<h:outputText id="nivel3" value="#{relatorioExtraBean.custoPorUnidadeFilter.nivel3.label}" />
					</td>
				</tr>
			</ui:fragment>
			<ui:fragment rendered="#{relatorioExtraBean.custoPorUnidadeFilter.nivel4 != null}">
				<tr>
					<td>
						<h:outputText value="Nível 4" />
					</td>
					<td colspan="3">
						<h:outputText id="nivel4" value="#{relatorioExtraBean.custoPorUnidadeFilter.nivel4.label}" />
					</td>
				</tr>
			</ui:fragment>
			<ui:fragment rendered="#{relatorioExtraBean.custoPorUnidadeFilter.nivel5 != null}">
				<tr>
					<td>
						<h:outputText value="Nível 5" />
					</td>
					<td colspan="3">
						<h:outputText id="nivel5" value="#{relatorioExtraBean.custoPorUnidadeFilter.nivel5.label}" />
					</td>
				</tr>
			</ui:fragment>
			<ui:fragment rendered="#{relatorioExtraBean.custoPorUnidadeFilter.nivel6 != null}">
				<tr>
					<td>
						<h:outputText value="Nível 6" />
					</td>
					<td colspan="3">
						<h:outputText id="nivel6" value="#{relatorioExtraBean.custoPorUnidadeFilter.nivel6.label}" />
					</td>
				</tr>
			</ui:fragment>
			<ui:fragment rendered="#{relatorioExtraBean.custoPorUnidadeFilter.nivel7 != null}">
				<tr>
					<td>
						<h:outputText value="Nível 7" />
					</td>
					<td colspan="3">
						<h:outputText id="nivel7" value="#{relatorioExtraBean.custoPorUnidadeFilter.nivel7.label}" />
					</td>
				</tr>
			</ui:fragment>
			<ui:fragment rendered="#{relatorioExtraBean.custoPorUnidadeFilter.nivel8 != null}">
				<tr>
					<td>
						<h:outputText value="Nível 8" />
					</td>
					<td colspan="3">
						<h:outputText id="nivel8" value="#{relatorioExtraBean.custoPorUnidadeFilter.nivel8.label}" />
					</td>
				</tr>
			</ui:fragment>
		</table>
		
		<center>
			<p:dataTable id="dtResultado" var="_item"
					value="#{relatorioExtraBean.custosPorUnidadesFiltered}" 
					emptyMessage="Não existem itens nesta lista."
					style="width: 99%;">
				
				<p:column headerText="Sigla">
					<h:outputText value="#{_item.sigla}" />
				</p:column>
				<p:column headerText="Nome da Unidade">
					<h:outputText value="#{_item.nomeUnidade}" />
				</p:column>
				<p:column headerText="Valor de Material" style="text-align: right;">
					<h:outputText value="#{_item.custoMaterial}" converter="bigDecimalConverter" />
				</p:column>
				<p:column headerText="Valor de Mão de Obra" style="text-align: right;">
					<h:outputText value="#{_item.custoMaoDeObra}" converter="bigDecimalConverter" />
				</p:column>
				<p:column headerText="Custo Total" style="text-align: right;">
					<h:outputText value="#{_item.custoTotal}" converter="bigDecimalConverter" />
				</p:column>
				<p:column headerText="OS Principal">
					<h:outputText value="#{_item.osPrincipal}" />
				</p:column>
				<p:column headerText="Sub OS">
					<h:outputText value="#{_item.subOs}" />
				</p:column>
				<p:column headerText="Data">
					<h:outputText value="#{_item.data}">
						<f:convertDateTime pattern="dd/MM/yyyy" type="both" />
					</h:outputText>
				</p:column>
				<p:column headerText="Demandante">
					<h:outputText value="#{_item.demandante}" />
				</p:column>
				<p:columnGroup type="footer" rendered="#{not empty relatorioExtraBean.custosPorUnidades}">
		            <p:row>
		                <p:column colspan="2" style="text-align: right;" footerText="Custo Total:" />
		                <p:column style="text-align: right;" footerText="#{relatorioExtraBean.totalMaterialCustoPorUnidade}" />
		                <p:column style="text-align: right;" footerText="#{relatorioExtraBean.totalMaoDeObraCustoPorUnidade}" />
		                <p:column style="text-align: right;" footerText="#{relatorioExtraBean.totalCustoPorUnidade}" />
		                <p:column colspan="4" footerText="" />
		            </p:row>
		        </p:columnGroup>
			</p:dataTable>
		</center>
		
		<br />
		Data de Impressão: 
		<h:outputText value="#{homeBean.dataAtual}">
			<f:convertDateTime pattern="dd/MM/yyyy HH:mm" type="both" timeZone="America/Sao_Paulo" /> 
		</h:outputText>
		
	</body>

</html>